# BUá»”I 14 â€“ CHáº Y JMETER á» CHáº¾ Äá»˜ NON-UI (CLI MODE)

## Má»¥c tiÃªu buá»•i há»c

Sau buá»•i nÃ y, há»c viÃªn cÃ³ thá»ƒ:

* Hiá»ƒu **vÃ¬ sao khi cháº¡y Performance Test pháº£i dÃ¹ng Non-UI (CLI Mode)**
* Biáº¿t **cÃ¡ch cháº¡y JMeter báº±ng command line**
* Biáº¿t **Ä‘á»c log console, file káº¿t quáº£ JTL, bÃ¡o cÃ¡o HTML**
* Biáº¿t **tÃ¹y biáº¿n tham sá»‘ test mÃ  khÃ´ng cáº§n má»Ÿ UI**
* Hiá»ƒu báº£n cháº¥t file JTL vÃ  cÃ¡ch gen láº¡i bÃ¡o cÃ¡o

---

## 1. Nháº¯c láº¡i kiáº¿n thá»©c vá» JMeter

### 1.1 Cháº¡y JMeter báº±ng UI (GUI Mode)

ğŸ‘‰ Má»¥c Ä‘Ã­ch chÃ­nh:

* Thiáº¿t káº¿ Test Plan
* Debug logic (request Ä‘Ãºng hay sai)
* Kiá»ƒm tra nhanh response

ğŸ‘‰ **KHÃ”NG dÃ¹ng Ä‘á»ƒ cháº¡y Performance Test tháº­t**

LÃ½ do:

* UI tiÃªu tá»‘n **ráº¥t nhiá»u RAM vÃ  CPU**
* Káº¿t quáº£ Ä‘o **khÃ´ng chÃ­nh xÃ¡c** (tÃ i nguyÃªn bá»‹ UI chiáº¿m)
* Dá»… bá»‹ treo khi sá»‘ thread lá»›n

ğŸ“Œ Káº¿t luáº­n:

> **GUI Mode chá»‰ dÃ¹ng Ä‘á»ƒ debug vÃ  build Test Plan**

---

### 1.2 Cháº¡y JMeter báº±ng CLI Mode (Non-UI)

ğŸ‘‰ Má»¥c Ä‘Ã­ch:

* Cháº¡y test chÃ­nh thá»©c
* Thu tháº­p dá»¯ liá»‡u
* Sinh bÃ¡o cÃ¡o

### VÃ¬ sao cáº§n cháº¡y CLI Mode?

âœ… **Tiáº¿t kiá»‡m tÃ i nguyÃªn**

* KhÃ´ng load UI â†’ giáº£m RAM/CPU

âœ… **Káº¿t quáº£ chÃ­nh xÃ¡c hÆ¡n**

* TÃ i nguyÃªn táº­p trung cho viá»‡c generate load

âœ… **Tá»•ng há»£p bÃ¡o cÃ¡o tá»± Ä‘á»™ng**

* Sinh bÃ¡o cÃ¡o HTML ngay sau khi cháº¡y

âœ… **Cháº¡y Ä‘Æ°á»£c trÃªn server khÃ´ng cÃ³ giao diá»‡n**

* Linux server, Docker, CI/CD (Jenkins, GitLab CIâ€¦)

ğŸ“Œ Trong thá»±c táº¿:

> **99% cháº¡y Performance Test lÃ  Non-UI**

---

## 2. CLI MODE â€“ CÃ¡c cÃ¢u lá»‡nh quan trá»ng

### 2.1 CÃ¢u lá»‡nh cháº¡y test + sinh bÃ¡o cÃ¡o (95% sá»­ dá»¥ng)

```bash
jmeter -n \
       -t TestBTH.jmx \
       -l ketqua.jtl \
       -e \
       -o html-report
```

#### Giáº£i thÃ­ch tham sá»‘

* `-n` : Non-UI mode
* `-t` : File Test Plan (.jmx)
* `-l` : File káº¿t quáº£ (.jtl)
* `-e` : Enable bÃ¡o cÃ¡o HTML
* `-o` : ThÆ° má»¥c chá»©a bÃ¡o cÃ¡o HTML

#### âš ï¸ LÆ¯U Ã QUAN TRá»ŒNG

* File `ketqua.jtl` **KHÃ”NG Ä‘Æ°á»£c tá»“n táº¡i trÆ°á»›c** â†’ náº¿u cÃ³ sáº½ **bÃ¡o lá»—i**
* ThÆ° má»¥c `html-report` **PHáº¢I TRá»NG** â†’ náº¿u khÃ´ng trá»‘ng sáº½ **bÃ¡o lá»—i**

ğŸ“Œ Thá»±c táº¿:

> 95% trÆ°á»ng há»£p chá»‰ cáº§n **1 cÃ¢u lá»‡nh nÃ y**

---

### 2.2 CÃ¢u lá»‡nh sinh bÃ¡o cÃ¡o tá»« file JTL cÃ³ sáºµn (5% trÆ°á»ng há»£p)

DÃ¹ng khi:

* Cháº¡y test trÆ°á»›c Ä‘Ã³ rá»“i
* Muá»‘n gen láº¡i report
* Hoáº·c chá»‰nh sá»­a file JTL

```bash
jmeter -g ketqua.jtl -o html-report
```

Trong Ä‘Ã³:

* `-g` : Generate report tá»« file JTL
* `-o` : ThÆ° má»¥c report HTML

---

## 3. Thá»±c hÃ nh: Táº¡o Test Plan vÃ  cháº¡y CLI

### 3.1 Chuáº©n bá»‹ thÆ° má»¥c

ğŸ‘‰ Má»i ngÆ°á»i táº¡o thÆ° má»¥c:

```text
Buoi14/
â”‚â”€â”€ TestBTH.jmx
â”‚â”€â”€ ketqua.jtl
â”‚â”€â”€ html-report/
```

---

### 3.2 Táº¡o Test Plan Ä‘Æ¡n giáº£n

#### YÃªu cáº§u Test Plan

* 1 Thread Group
* 2 Dummy Sampler

#### Cáº¥u hÃ¬nh:

* Dummy Request 1: **PASS**

  * Response Code: `200`
  * Response Message: `OK`

* Dummy Request 2: **FAILED**

  * Response Code: `500`
  * Response Message: `Internal Server Error`

ğŸ“Œ Má»¥c Ä‘Ã­ch:

> Táº¡o tá»· lá»‡ **pass / fail** Ä‘á»ƒ quan sÃ¡t bÃ¡o cÃ¡o

---

### 3.3 Cáº¥u hÃ¬nh Thread Group (vÃ­ dá»¥)

* Number of Threads (Users): `10`
* Ramp-up Period: `5`
* Loop Count: `2`

---

### 3.4 Cháº¡y test báº±ng CLI

```bash
jmeter -n -t TestBTH.jmx -l ketqua.jtl -e -o html-report
```

---

## 4. Quan sÃ¡t káº¿t quáº£ khi cháº¡y

### 4.1 CÃ¡c file/thÆ° má»¥c sinh ra

* `ketqua.jtl` â†’ File káº¿t quáº£ raw
* `html-report/` â†’ BÃ¡o cÃ¡o HTML

---

### 4.2 ThÃ´ng tin hiá»ƒn thá»‹ trÃªn console

VÃ­ dá»¥:

```text
Starting the test @ Wed Dec 17 19:00:00 ICT 2025
summary + 40 in 00:00:05 = 8.0/s Avg: 50 Min: 10 Max: 120 Err: 20 (50.00%)
summary = 40 in 00:00:05 = 8.0/s Avg: 50 Min: 10 Max: 120 Err: 20 (50.00%)
```

Giáº£i thÃ­ch:

* `40` : Tá»•ng sá»‘ sample
* `8.0/s` : Throughput
* `Avg / Min / Max` : Response time
* `Err: 20 (50%)` : Tá»· lá»‡ lá»—i

---

## 5. Äáº·t váº¥n Ä‘á» & Giáº£i phÃ¡p

### Váº¥n Ä‘á» 1: Thay Ä‘á»•i Thread, Ramp-up mÃ  khÃ´ng má»Ÿ UI?

ğŸ‘‰ Náº¿u server **khÃ´ng cÃ³ giao diá»‡n** thÃ¬ sao?

âœ… Giáº£i phÃ¡p: **JMeter Property (-J)**

VÃ­ dá»¥:

```bash
jmeter -n -t TestBTH.jmx \
       -l ketqua.jtl \
       -e -o html-report \
       -Jthreads=50 \
       -Jrampup=10
```

Trong Test Plan:

* Threads = `${__P(threads,10)}`
* Ramp-up = `${__P(rampup,5)}`

ğŸ“Œ Máº·c Ä‘á»‹nh náº¿u khÃ´ng truyá»n `-J` â†’ dÃ¹ng giÃ¡ trá»‹ fallback

---

### Váº¥n Ä‘á» 2: CÃ³ lá»—i â†’ lÃ m sao biáº¿t lá»—i gÃ¬?

ğŸ‘‰ CLI **KHÃ”NG hiá»ƒn thá»‹ response chi tiáº¿t**

âœ… Giáº£i phÃ¡p:

* DÃ¹ng **View Results Tree**
* Chá»‰ báº­t khi **cÃ³ lá»—i**

Cáº¥u hÃ¬nh:

* Tick: `Errors`
* KhÃ´ng tick: Success

ğŸ“Œ Má»¥c Ä‘Ã­ch:

> Láº¥y request / response â†’ gá»­i Dev check log

---

## 6. Giá»›i thiá»‡u bÃ¡o cÃ¡o HTML cá»§a JMeter

BÃ¡o cÃ¡o bao gá»“m:

* Dashboard tá»•ng quan
* Throughput
* Response Time
* Error Rate
* Active Threads

ğŸ“Œ BÃ¡o cÃ¡o dÃ¹ng Ä‘á»ƒ:

* ÄÃ¡nh giÃ¡ hiá»‡u nÄƒng tá»•ng thá»ƒ
* TrÃ¬nh bÃ y vá»›i PM / khÃ¡ch hÃ ng

---

## 7. Tá»‘i Æ°u JMeter khi cháº¡y Non-UI

### 7.1 Cáº¥u hÃ¬nh HEAP (RAM)

ğŸ‘‰ Khuyáº¿n nghá»‹:
set HEAP=-Xms
> **HEAP â‰ˆ 70â€“80% RAM váº­t lÃ½**

VÃ­ dá»¥ mÃ¡y 16GB RAM:

```text
-Xms8g
-Xmx12g
```

---

### 7.2 ThÆ° má»¥c backup dá»¯ liá»‡u
jmeter.gui.action.save.backup_directory
* TrÃ¡nh máº¥t file JTL
* Phá»¥c vá»¥ gen report láº¡i

---

## 8. Báº£n cháº¥t file JTL & Gen láº¡i bÃ¡o cÃ¡o

### 8.1 Báº£n cháº¥t file JTL

ğŸ‘‰ File `.jtl` thá»±c cháº¥t lÃ :

* **CSV (Comma Separated Values)**

â¡ï¸ CÃ³ thá»ƒ:

* Má»Ÿ báº±ng Excel
* Má»Ÿ báº±ng Notepad
* Chá»‰nh sá»­a thá»§ cÃ´ng

---

### 8.2 Demo: Chá»‰nh file JTL

* Má»Ÿ `ketqua.jtl`
* ThÃªm 1 dÃ²ng sample há»£p lá»‡
* LÆ°u láº¡i

Gen láº¡i bÃ¡o cÃ¡o:

```bash
jmeter -g ketqua.jtl -o final-report
```

ğŸ‘‰ Káº¿t quáº£:

* Tá»•ng sá»‘ sample **tÄƒng thÃªm 1**

ğŸ“Œ Ã nghÄ©a:

> BÃ¡o cÃ¡o HTML **phá»¥ thuá»™c hoÃ n toÃ n vÃ o dá»¯ liá»‡u JTL**

---

## 9. Tá»•ng káº¿t

âœ… GUI: Build & Debug
âœ… CLI: Run & Report
âœ… Non-UI lÃ  tiÃªu chuáº©n trong Performance Test

ğŸ‘‰ Buá»•i sau:

* Cháº¡y JMeter báº±ng script
* TÃ­ch há»£p CI/CD

---

ğŸ¯ **End of Buá»•i 14**
