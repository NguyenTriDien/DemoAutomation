Chào m?i ngu?i. Hôm nay mình dên voi noi dung buoi h?c th? 4 c?a khóa h?c Performance test v?i Jmeter.
Chúng ta dã tr?i qua 2 n?i dung dó là v? overview performance test ? bu?i 1. Và cung dã dia qua mootj lu?t các khái ni?m liên quan v? m?t h? th?ng backend server.
Hôm nay chúng mình ti?p t?c m?t bu?i overview n?a v? Jmeter. Tru?c khi di detail v? nó ? các bu?i sau thì chúng ta cungx c?n có cái nhìn t?ng quan v? nó tru?c ha.
Ð? xem tool này nó là gì, nó làm du?c gì. Và các c?u ph?n ch?c nang c?a nó thì chúng ta s? demo và di qua nhanh m?t lu?t. M?i ngu?i yên tâm là t?t c? thành phân quan tr?ng
ch? ch?t c?a Jmeter chúng ta s? tìm hi?u chi ti?t vào các bu?i sau ha.
Không bi?t có b?n nào chua cài d?t du?c jmeter không a. Ok tru?c khi di vào chi ti?t bu?i hôm nay m?i ngu?i làm giúp em  m?t vi?c nhu sau nhá.
-- Hu?ng dân c?u hình các thu c?n thi?t
1. Gi?i thi?u v? Jmeter

- Là m?t opensource du?c phát hành b?i Apache Software Foundation
- Jmeter du?c vi?t 100% b?ng java

-> Vì là opensource nên jmeter là mi?n phí nên ai mu?n s? d?ng cung du?c. Và source code c?a Jmeter cung du?c public ra c?ng d?ng luôn. Cho nên ai mu?n tìm hi?u cách mà jmeter du?c t?o ra,
bên trong g?m nh?ng thành ph?n gì thì m?i ngu?i có th? t?i source code nó v? d?c ha. Th?m chí n?u có d? ki?n th?c thì m?i ngu?i có th? custome l?i source code c?a nó theo í mu?n c?a mình.
Em có vi?t thêm các ch?c nang cho Jmeter vì d?c thù công vi?c c?n thi?t. Thì em s? d?y lên cho mn s? d?ng n?u có nhu c?u ha. M?t s? ch?c nang em t? vi?t thêm mn có th? tham kh?o ha.
++++++++++++

- Ði?u thú v? v? jmeter dó là lúc mà nó du?c t?o ra thì m?c dích ban d?u c?a nó dùng cho functional web application test ha.Sau này thì nó m?i du?c c?i ti?n phát tri?n tr? thành tool chuyên bi?t
cho performance test. Cung chính vì di?u dó nên dén hi?n t?i thì mn v?n có th? dùng jmeter d? làm automation test duc? ha. Mn có th? tìm hi?u thêm v? Selenium webdriver with jmeter.
Nhung mà chúng ta ch? nên xem các tính nang automation test dó là b? tr? thôi ha. Còn d? làm automation test thì nên s? d?ng các công c? chuyên bi?t nhu Selenium, Serenity,... thì s? hi?u qu? hon.

2. Ph?n ti?p theo chúng ta s? tìm hi?u v? cách mà jmeter ho?t d?ng. Mình s? d?ng nó mà nên c?n bi?t du?c cách mà nó v?n hành
--> Show hình so d? trên slide
- V? b?n ch?t khi mà Jmeter nó ho?t d?ng. Thì nó s? gi? l?p request g?i lên server. Thì client g?i lên server cái gì thì jmeter s? b?t chu?c và gi?i l?p i chang. Và nó dóng vai trò nhu m?t client g?i
request lên server.
- Sau dó server s? ti?p nh?n và x? lí request và response v?
- Jmeter s? ti?p nh?n response dó gi?ng nhu client ha. Client g?i request di và ti?p nh?n response v? dúng k.
- Sau khi mà nó ti?p nh?n các response dó thì nó ti?n hành thu th?p các thông tin c?n thi?t v? request dó
- Ghi lại các thông số quan trọng:
 +Thời gian bắt đầu (start time).
 +Thời gian kết thúc (end time).
 + Thời gian phản hồi (response time).
 + Mã phản hồi (status code)…
Và m?t s? thông s? quan trong khác ha. Và m?i request thì nó s? th?c hi?n m?t chu trình nhu v?y ha. Ví d? mình g?i N request thì nó cung th?c hi?n N vòng l?p nhu th? ha.
Và sau khi th?c hi?n và gom du?c n request dó thì nó s? x? lí và dua ra k?t qu? cu?i cùng.

----> Ð?n dây em nh?n m?nh l?i m?t chút và mn n?m rõ m?t di?u giúp em. Bu?i 1 e cung có d? c?p m?t l?n r?i. 
Chúng ta test performance ? phía server side. Khi m?i ngu?i nói d?n performance test thì 95 -> 99% chúng ta dang nói d?n vi?c performance test ? phía server ha.
Lý do thì bu?i 1 em có nói qua r?i.
+Lý do 1: Khi mình có m?t ?ng d?ng ha. Thì client có th? có r?t nhi?u. Web application, Mobile vân vân và mây mây ha. Nhung server ch? có 1. Dù có bao nhiêu client di n?a thì request cung s? d? v? m?t hu?ng dó là
Server ha. Có N client cùng g?i request lên server thì server ph?i x? lí N request dó cùng lúc thì lúc dó chúng ta m?i cân di do performance ha
+Lý do 2: Server (service) chính là noi x? lí t?t c? nghi?p v? c?a m?t ?ng d?ng ha. Và nó là noi giao ti?p v?i database

---> Ok ch?t l?i ha. Nói v? performance test thì ta dang nói d?n test performance ? phía server side. Và jmeter dang dóng vai trò gi?i l?p client g?i request lên server. Và các tool khác cung th? thôi ha. B?n ch?t cung là
gi?i l?p client g?i request lên server và thu th?p các ch? s? d? dánh giá server ha. N?m rõ du?c b?n chât thì sau này các b?n có ti?p cân v?i các công c? khác thì cung r?t nhanh ha. Vì mindset nó ch? có v?y thoi ha.
Ví d?: Công ty các b?n có phát tri?n m?t ?ng d?ng ch?y trên mobile app ch?ng h?n. M?t ngày depk troi b?n du?c yêu câu test performance cho cái app dó. Thì ch? này b?n ch?t là các b?n không ph?i di test performance cho cái 
app dó. Mà công vi?c c?n làm là các b?n ph?i di test performance cho cái server mà cái app dó g?i d?n. Lúc này các b?n c?n gi?i l?p các request mà cái app dó g?i lên server ha. 
Ch? này có m?t cái luu í nhu sau d? các b?n tránh nh?m l?n ha. N?u các b?n nh?n du?c yêu c?u test xem cái app dó dùng có b? nóng máy không. Có b? hao h?t pin nhanh hay không. Khi cài lên thì các ?ng d?ng khac trong máy có
x?y ra v?n d? gì hay không(Ch?m treo,....) xung d?t ?ng d?ng không. Thì dó không ph?i là performance test ha. Mà b?n ch?t dó ch? là m?t lo?i Non-Functional Testing thôi.
Có th? g?i nó là Compatibility Testing (Kiểm thử tương thích).
---> Chúng ta không c?n quan tâm d?n client dó là gì mi?n nó có server d? handle request. Th? mà chúng ta quan tâm là client dó g?i request lên server b?ng cách nào. Và jmeter có h? tr? giao th?c dó hay không.
---> Vì th? cho nên n?u mn g?p m?t câu h?i Jmeter có h? tr? test mobile app hay không. Thì chúng ta ch? c?n tr? l?i là chúng ta không test performance cho cái app dó. Mà chúng ta ch? c?n xem cách mà app dó
g?i request lên server và chúng ta b?t chu?c cái cách mà app dó g?i request lên server khi mà chúng ta b?t chu?c du?c thì chúng ta t? l?i có th? dùng jmeter d? test du?c cho server c?a app dó ha.

3. JMeter có thể làm gì??
Web application
+ Http
+ Https
--> Html....
Trong Automation thì mình có khái ni?m là DOM.
Web service (Api)
+ Http, https
--> Json, XML,...
-----> Chúng ta ch? y?u t?p trung vào các giao th?c này ha vì hi?n t?i 90% các ?ng d?ng dung s? d?ng giao thuc này
Bên c?nh dó chúng ta có 
+ FPT -> File transfer --> Driver luu tr? file, truy?n t?i file
+ Mail
+ Jdbc: Vì jmeter du?c vi?t b?ng Java mà java giao ti?p v?i csdl b?ng jdbc
+ Native command: Ki?u nhu m? CMD gõ ping 8.8.8.8 ...

4. Cách chạy JMeter
+ UI Mode
---> Là nút xanh xanh này các b?n b?m vào ch?y
+ Chúng ta ch? d?ng UI Mode này d? t?o và debug testplan thôi nhé. Ngay khi các b?n  m? Jmeter nó có m?t dòng wanrning r?t rõ.

+ NonUI: Ðây là cách ch?y dúng khi th?c hi?n run test performance ha.
5. Kiến trúc của Jmeter
- Shot cut -> Hi?n t?i các b?n ch? c?n d? í giúp mình cái nút Tam giac màu xanh này ha. Và nút hình cái ch?i  này thôi
- V? giao di?n c?a Jmeter thì nó s? du?c chia b? c?c thành 2 ph?n
 + Bên trái: Ðây là ph?n mình c?u hình testplan. Toàn b? các thành ph?n t?o testplan khi mình t?o ra thì nó d?u n?m ? bên này.
Ví d?: Threadgroup, Config element,..
 + Bên ph?i: Khi mà các b?n ch?n vào b?t kì m?t cái c?u hình nào dó thì tuong ?ng bên pha? nó s? hi?n th? các c?u hình chi ti?t tuong ?ng vào config dó ha.
Ví d?: Http request
 --> Gi?i thi?u thôi k demo
- TestPlan: M?t testscript thì ch? có m?t testplan duy nh?t ha. Chúng ta không th? t?o thêm 1 testplan th? 2 trong testplan khác ha.
- Thread Group: Các b?n hi?u nó nhu là m?t Testsuite. Noi nó t?p h?p các test case c?a m?i ngu?i trong manual í. Vì lí thuy?t c?a Thread Group thì nó vi?t là b?n ch?t c?a m?t Thread Group là d?i di?n cho m?t nhóm các action
ho?c m?t nhóm các user th?c hi?n các action nào dó. Và trong Testplan b?t bu?c ph?i  có ít nh?t 1 ho?c nhi?u ThreadGroup.
Ví d?: 
 Threadgroup 1: Login
 ThreadGroup 2: Dashboard
 ThreadGroup 3: Orders
--> Và các test ? trong các ThreadGroup này khi mà run thì chúng s? du?c run song song cùng nhau
- TheadGroup trong Jmeter thì nó có 3 cái lo?i chính. Gi?ng nhu automation test m?i ngu?i hay có các annoation ki?u nhw
+ @Before : S? du?c th?c thi tru?c khi các test scenario duc? ch?y
+ @After: S? du?c th?c thi sau khi các scenario ch?y xong
Thì v?i Jmeter cung v?y nó cung cung câp cho chung ta các ThreadGroup d? làm di?u dó
+ setUp Thread Group
+ tearDown Thread Group
--> Ch? nói qua thôi không di quá chi ti?t.

---> Ok chúng ta quay l?i v?i thành ph?n quan tr?ng nh?t nào. Ðó là ThreadGroupd
Nhu có d? c?p o trên 1 TestPlan n?u không có ThreadGroup nào thì TestPlan dó không dùng d? làm gì c?. Và nói cách khác là TestPlan dó không h?p l?
--> OK khi mn d?ng ? TheadGroupd và Click chu?t trái
Thì t?t c? m?i th? quan tr?ng nh?t c?a Jmeter dùng d? c?u hình TestPlan d?u n?m trong này.
Click chu?t ph?i -> Ðây là t?t c? m?i th? quan tr?ng nh?t. Thì trong bu?i hôm nay chúng ta s? c? g?ng di h?t m?t lu?t các thành ph?n này ha. Mình s? tìm hi?u so qua xem các Componon này nó là gì và nó dùng d? gi?i quy?t bài toán gì ha
--> Ð?u tiên
***** Sampler: Ðây chính là request mà mình gi? l?p g?i lên server ha. Thì trong  này chính là m?t danh sách các d?ng mà Jmeter h? tr? gi?i lâp nha.
 + Http request  này
 + FPT request này
 + SMTP request này (Mail server)
--> Ðâu chính là thành ph?n c?t lõi nh?t c?a Jmeter ha. Và m?c d? quan tr?ng không kém so v?i ThreadGroup. Có th? hi?u don gi?n là
M?i TestPlan n?u không có ThreadGroupd thì TestPlan dó không h?p l?. Và TheadGroup mà không ch?a Sample thì ThreadGroup d?y không dùng d? làm gì c?. --> Vô d?ng

Ví d? v? trang ch? Jmeter:
https://jmeter.apache.org/index.html
Nhìn thì chúng ta th?y có r?t nhi?u input ha. Nhung th?c t?t chúng ta ch? c?n quan tâm d?n m?t s? thông tin sau
protocol: https -> Defaul thì Jmeter s? nh?n là HTTP ha. 
Server Name or IP: jmeter.apache.org
Port Number: HTTP -> 8080, HTTPS -> 443 -> Defaul thì Jmeter s? t? nh?n bi?t d?a vào protocol -> Ði?n cung du?c mà không di?n cung du?c
Method: GET
Path: /index.html
******* Truoc khi run mn thêm giúp em m?t cái sau. Ð?ng ? TestPlan thêm giúp em View result tree
--> Listener là m?t componon giúp mn view k?t qu? test theo nhi?u chi?u view khác nhau ha. D?ng cây, d?ng b?ng, d?ng bi?u d?. View result tree là d?ng listener huu ích nhât cho moi nguoi trong qua trình làm TestPlan ha
--> Ok d?n dây chua v?i run ha. View result tree mình dang t?o ra o level TestPlan thì nó s? áp d?ng cho t?t c? Sample trong t?t c? ThreadGroup ha. Còn n?u m?i ngu?i t?o View result tree trong 1 ThreadGroupd thì nó
ch? áp d?ng cho các Sample ? trong ThreadGroupd dó. Và n?u mn t?o ta du?i 1 sample thì nó ch? áp d?ng cho chính Sample dó thôi ha

--> ? dây ta th?y ph?m vi áp d?ng c?a nó là gì ?. Là áp d?ng cho t?t c? m?i request dúng du?i nó (Nghia là dúng du?i level c?a nó nhé. Ch? không ph?i d?ng theo v? trí trên giao di?n dâu nhé. M?i ngu?i luu í ch? này)
--> Demo kéo len kéo xu?ng ......

OK bây gi? m?i ngu?i click vào nút tam giác xem nó run ra gi?ng nhu em không ?.

- Ti?p theo tuong t? m?i ngu?i config thêm cho em m?t request th? 2.
https://www.apache.org/licenses/
Mn c?u hình tuong t? nhu overview nhá!
--> Run thu xem ok nhu này chua ?
- Ti?p theo mn c?u hình thêm cho em m?t request n?a nhá
https://jmeter.apache.org/download_jmeter.cgi
Thì ? dây mn setup nhanh b?ng cách Ctr + C -> Ctr + V d? copy nhanh Sample và s?a l?i ha. Ðây ch ? khác nhau Path thôi nên ch? c?n d?i path là ok .
-> Cle? log cu di b?ng cách b?m vào cái Ch?i ho?c Ctrl + E ha
-> Run l?i b?ng cách b?m Tam giác ho?c CTRL + R nha
****** Config Element
--> M?i ngu?i nhìn vào 3 request này th?y có di?m gì gi?ng nhau k  ?
-> Https
-> Domain
Ví d? truong h?p nhu sau. M?i ngu?i làm TestPlan cho m?i s?n ph?m nào dó ch?ng h?n. C?u hình xong t?m 100 request di. Sau d?y dev d?i domain dúng k. Thì mn c?n ph?i làm sao ?
-> Ði vào t?ng request d? d?i dúng k-> V?n work . Và c?u hình xong 100 request dó. Sang m?t ngày d?p tr?i l?i d?i domain
--> Có cách nào giúp chúng ta do t?n công s?c hon khong khi mà có s? thay d?i c?a các thông s? du?c s? d?ng nhi?u noi không???
***** User Defined Variables -> Là noi chúng ta khai báo t?t c? các bi?n dùng chung. Và tuong t? nhu Listener thì ph?m vi áp d?ng c?a th?ng này cung tuong t? ha. Thông thu?ng nh?ng th? liên quan d?n 
config thì ta nên d? lên dau cho de quan tr? ha.
protocol: https
port: 443
host: jmeter.apache.org
--> Chúng ta dã d?nh nghia du?c các bi?n r?i. Thì câu chuy?n bây gi? là dùng các bi?n này b?ng cách nào
--> Jmeter cung c?p cú pháp g?i bi?n nhu sau: ${varName}.
Chúng ta cùng nhau s?a lai TestPlan nào
------- Run l?i --> Pass
Ð?n dây ta th?y TestPlan b?t d?u t?i uu d? maintain hon r?i ha. Nhung chúng ta ti?p t?c de í là. T?t c? request trong Testplan d? c?n khai báo Protocal, Domain, Host.
Vây có cách nào chúng ta ch? c?n khai báo m?c dinh 1 làn thôi không. Ð? các request còn l?i ch? vi?t an theo mac dinh cái chung ta khai bao ban d?u. Và chúng ta ch? c?n thay d?i các thông s? c?n thay d?i thôi thì 
s? t?i uu hon dúng k.

***** HTTP Request Defaults
--> Các b?n run th? xem work không ?

**** Logic controler
Ok nhu m?i nguoi th?y th? t? th?c thi Sample trong ThreadGroup là nhu nào ?
-> Th? t? l?n lu?t t? trên xu?ng dúng k? Nhung th?c t? trong công vi?c chúng ta c?n nhi?u hon th?. Chúng ta mong mu?n thay d?i cách thuc thi th? t? c?a các sample. 
Ví d? Random, Song song,...
Thì lúc này chúng ta c?n d?n s? tr? giúp c?a m?t Componon có tên là **Logic controler
-> Trong này chua danh sách t?t c? cac Controler mà Jmeter h? tr? ha. Chúng ta s? có m?t buôi chi ti?t v? các Controler hay s? d?ng và cách dùng nó ha. Buôi hôm nay chúng ta di overview thôi
Ví d? em c?n ch?y random th? t? các request ch?ng h?n
Click chu?t ph?i -> Add -> Logic controler -> Random Order Controller
-> Run vài l?n dê thay kêt qua khac nhau
 *** Timer
Mn d? í nhá lúc mình ch?y rõ ràng là Jmeter ch?y l?n lu?t các request theo logic sau
Request 1 -> Ch? response1 -> Request 2 -> Response2 -> Request 3
Thì m?c d?nh c?a Jmeter thì s? không có khoang th?i gian nào ng?ng ngh? gi?a các request c?. Nhung mà th?c t? rõ ràng là ngu?i dùng h? vào overvew xong thì h? chua h? vào License luôn dúng k.
Mà h? s? ch?m l?i ng?ng m?t chút d? d?c thông tin xem trang nay có gì dã. Kho?ng th?i gian này g?i là ThinkTime -> Thoi gian suy nghi  -> Constant Timer
--> Ph?m vi áp d?ng tuong t? ha. Và Timer này s? ho?t d?ng nhu th? nào ?.
? dây có 2 k?ch b?n x?y ra nhu sau. M?i ngu?i th? ch?y r?i tr? l?i xem k?ch b?n nào dúng ha
 Request 1 -> Timer -> Request 2 -> Timer -> Request 3 -> Timer ???
Timer -> Request 1 -> Timer -> Request 2 -> Timer -> Request 3 ??? -> YES
-> Timer s? ch?y tru?c khi request b?t d?u
**** Assertion
--> M?i ngu?i quan sat log th?y n ó xanh xanh không ?. Thì cam quan theo logic bình thuognwf thì mình t?m cho nó là Pass dúng k. Thì m?c d?nh Jmeter dua vào status code d? cho nó là pass hay fail ha.
Chúng ta cung có 1 bu?i d? di chi ti?t v? v?n d? này.
M?i ngu?i làm Manaual hay Automation cung th?. Chúng ta luôn có Expected khi mà th?c thi dúng k.
Manual: Dùng m?t d? check xem response tr? v? có dúng nhu mong mu?n không
Aumation: Assert equals, Assert True,...
Performance cung th? dúng k. Mình g?i request di thì cung can kiem tra xem nhu nào nào là mot request pass. Ð? ki?m tra du?c thì Jmeter cung c?p cho chúng ta m?t thành ph?n g?i là Assertions
Assertion thì chúng ta hay assert trên request dúng k. Thì theo ph?m vi áp d?ng c?a Assertion cung nhu m?y config khác thôi. Vì là assert trên request nên chúng ta d?ng ? request
Click chu?t ph?i -> Add -> Assertions -> Response Assertion
********What can I do with it?*******
--> Run -> Xanh Passs
Còn n?u tài li?u thi?t k? yêu c?u khi vào trang Overview ph?a có Text 
****Wellcome Jmeter****
S?a assert 
--> Run fail.....

8. Cấu trúc của một dự án Performacne test
-> Ph?n này m?i ngu?i d?c qua d? bi?t tru?c và chua cân c?u hình theo vôi ha. Các bu?i h?c sau chúng ta s? v?a th?c hành v?a back l?i câu trúc này và c?u hình theo nhé ?




